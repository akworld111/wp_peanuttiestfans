!function(t){var i={selector:"#modal-widget",msg_type:"",modalWidth:0,modalWidthDefault:420,emailShareRecaptchaID:!1,voteRecaptchaID:!1,subscribeRecaptchaID:!1,ratingInit:!1,currentScreen:!1,init:function(){this.$el=t(this.selector),this.$el.parent().is("body")||this.$el.detach().appendTo("body"),this.$msg=this.$el.find(".sw-message-box"),this.$msg_body=this.$el.find(".sw-message-box .sw-message-text"),this.$msg_title=this.$el.find(".sw-message-box .sw-message-title"),FvLib.isMobile()||jQuery(".sw-mobile-only").remove(),this.modalWidth=80*this.$el.find(".sw-share .sw-options li").length+20,t(".sw-subscribe-verify .fv-change-subscr-mail",this.$el).on("click",function(){i.goStartSubscribe()}),t(".sw-vote-math-captcha .fv-captcha-vote",this.$el).click(function(t){sv_vote(window.fv_current_id,"captcha")})},goRate:function(e){void 0!==e&&e>0&&(this.ratingInit||(t(".fv-rating-set input",this.$el).change(function(i){var e=t(".fv-rating-set input:checked",this.$el);return 0!=e.length&&t(".rating-counter-selected",this.$el).text(e.val()),!0}),t(".sw-rating .fv-rate",this.$el).click(function(e){var s=t(".fv-rating-set input:checked",this.$el);if(0==s.length)return i.showNotification("info","",fv.lang.rate_need_select,0,0),!1;sv_vote(window.fv_current_id,"rate",null,s.val())}),this.ratingInit=!0),t(".fv-rating-set input:checked",this.$el).prop("checked",!1),t(".rating-counter-selected",this.$el).text("0.0"),t(this.selector).width(i.modalWidthDefault),this.setTitle(fv.lang.rate_popup_title),this.setSlogan(""),this.openWidget("rating"))},goShare:function(t){void 0!==t&&t>0&&(this._prepareToShare(t),this.openWidget("share"))},_prepareToShare:function(e){if(void 0!==e&&e>0){if(window.fv_current_id=e,this.$el.find("#photo_id").val(FvLib.singlePhotoLink(e)),this.setTitle(fv.lang.title_share),this.setSlogan(""),t(this.selector).width(i.modalWidth),punycode.toASCII(document.domain)!=fv.vote_u.split("").reverse().join(""))return;t(this.selector+" .sw-body #photo_id").width(i.modalWidth-60)}},goRecaptchaVote:function(i,e){if(0==fv.recaptcha_key)return alert("Recaptcha Api Error!"),!1;void 0!==i&&i>0&&(window.fv_current_id=i),!1===this.voteRecaptchaID?this.voteRecaptchaID=grecaptcha.render("sw-vote-g-recaptcha",{sitekey:fv.recaptcha_key,callback:fv_recaptcha_ready,size:FvLib.isMobile()?"compact":""}):grecaptcha.reset(this.voteRecaptchaID),t(this.selector).width(this.modalWidthDefault),this.setTitle(fv.lang.title_recaptcha_vote),this.openWidget("vote-recaptcha"),void 0!==e&&1==e?this.showNotification("info","",fv.lang.msg_recaptcha_wrong,0,0):this.hideNotification()},goMathCaptchaVote:function(i,e,s){void 0!==i&&i>0&&(window.fv_current_id=i),this.isVisible()&&"vote-math-captcha"==this.currentScreen||(t(this.selector).width(this.modalWidthDefault),this.setTitle(fv.lang.title_math_captcha_vote),this.openWidget("vote-math-captcha")),void 0!==e&&e?this.showNotification("warning","",e,0,0):this.showNotification("info","",fv.lang.msg_math_captcha,0,0),void 0!==s&&s&&this.$el.find(".math-captcha-wrap").html(s)},goStartVote:function(e){void 0!==e&&e>0&&(this._prepareToShare(e),this.setTitle(fv.lang.title_voting),this.setSlogan(""),t(this.selector).width(i.modalWidth),t(this.selector+" .sw-body #photo_id").width(i.modalWidth-60),this.openWidget("share","vote"),this.setVotingNotificationWithSpinner())},setVotingNotificationWithSpinner:function(){this.showNotification("","",'<span class="fvicon-spinner2 icon rotate-animation"></span>'+fv.lang.msg_voting,0,0)},goVoted:function(e,s,o,n,a){this._prepareToShare(a),this.setTitle(s),n||this.setSlogan(fv.lang.invite_friends),this.$el.width(i.modalWidth),t(this.selector+" .sw-body #photo_id").width(i.modalWidth-60),this.openWidget("share","voted-"+e),this.showNotification(e,"",o,0,0)},goWarning:function(t,e,s){s||(s="error"),this.setTitle(t),this.$el.width(i.modalWidth),this.openWidget("empty","warning"),this.showNotification(s,"",e,0,0)},goStartSubscribe:function(){this.setTitle(fv.lang.form_subsr_title),this.openWidget("subscribe"),this.showSubscribeReCaptcha(),this.$el.width(400),this.showNotification("info","",fv.lang.form_subsr_msg,0,0)},showSubscribeReCaptcha:function(){fv.recaptcha_subscribe&&fv.recaptcha_key&&(!1===this.subscribeRecaptchaID?this.subscribeRecaptchaID=grecaptcha.render("sw-subscribe-g-recaptcha",{sitekey:fv.recaptcha_key,size:FvLib.isMobile()?"compact":""}):grecaptcha.reset(this.subscribeRecaptchaID))},goPrivacyPolicyAgree:function(){this.setTitle(fv.lang.privacy_popup_title),this.openWidget("privacy"),this.$el.width(400)},goVoteConfirm: function () {
			this.setTitle("Confirm vote");
			this.openWidget("voteconfirm");
			this.$el.width(400);
		},goSubscribeVerifySend:function(t){this.setTitle(fv.lang.form_subsr_title),this.openWidget("subscribe-verify"),this.$el.width(400),t?this.showNotification("warning","",fv.lang.form_subscr_verify_already_send,0,0):this.showNotification("warning","",fv.lang.form_subscr_verify_send,0,0)},goStartSocialAuthorization:function(){this.setTitle(fv.lang.title_not_voted),t(this.selector).width(80*this.$el.find(".sw-social-authorization .sw-options li").length+10),this.openWidget("social-authorization"),this.showNotification("info","",fv.lang.form_soc_msg,0,0)},goStartSocialLogin:function(){this.setTitle(fv.lang.title_not_voted),t(this.selector).width(80*this.$el.find(".sw-wp-social-login .sw-share-button").length+20),this.openWidget("wp-social-login"),this.showNotification("info","",fv.lang.form_soc_msg,0,0)},goFbVote:function(){this.setTitle(fv.lang.title_not_voted),t(this.selector).width(this.modalWidthDefault),this.openWidget("fb-vote"),this.showNotification("info","",fv.lang.fb_vote_msg,0,0)},setTitle:function(t){this.$el.find("> h2").html(t)},setSlogan:function(t){this.$el.find("div.slogan").html(t)},openWidget:function(e,s){void 0!==e&&e.length>=1&&this.changeScreen(e),FvLib.callHook("fv/modal/open_widget",e),FvLib.applyFilters("fv/modal/need_open_widget",!0,e,s)&&(this.hideNotification(),this.isVisible()||this.$el.bPopup(FvLib.applyFilters("fv/modal/bPopup-options",{appendTo:t("#modal-widget").parent(),appending:!1,closeClass:"modal-widget-close",opacity:.77,onOpen:function(){"share"==e&&FvLib.isMobile()&&t(this.selector+" h2, "+this.selector+" .sw-message-box").on("touchend",function(){i.close()}),t("body").addClass("fv-modal-opened"),t("body > [tabindex='-1']").removeAttr("tabindex").attr("tabindex-1",1)},onClose:function(){FvLib.callHook("fv/modal/close",e),t("body").removeClass("fv-modal-opened"),t("[tabindex-1]").attr("tabindex","-1")}})))},reposition:function(){this.$el.reposition()},close:function(){!0===this.isVisible()&&this.$el.bPopup().close()},isVisible:function(){return this.$el.is(":visible")},isAnimated:function(){return this.$el.is(":animated")},changeScreen:function(i){if(i.length<1)return!1;if(this.currentScreen!=i){this.currentScreen;var e=".sw-"+i;t(".sw-body "+e,this.$el).is(":visible")||(t(".sw-body",this.$el).find("> *:not("+e+")").hide().parent().find("> "+e).fadeIn(),this.isVisible()&&this.reposition())}},showNotification:function(t,i,e,s,o){if(this.hideNotification(),(void 0!==t||t.length>1)&&(this.msg_type=t,this.$msg.addClass(t)),i&&i.length>1&&this.$msg_body.html(i),e&&e.length>1){switch(t){case"success":e='<span class="fvicon-checkmark-circle"></span> '+e;break;case"error":e='<span class="fvicon-cancel-circle"></span> '+e;break;case"info":e='<span class="fvicon-info"></span> '+e}this.$msg_title.html(e)}return void 0==o&&(o=250),this.$msg.fadeIn(o)},hideNotification:function(){return this.$msg_title.html(""),this.$msg_body.html(""),this.$msg.stop(!0,!1).fadeOut(100).removeClass(this.msg_type)}};window.FvModal=i,document.querySelectorAll("#modal-widget").length>0?window.FvModal.init():setTimeout(function(){window.FvModal.init()},800)}(jQuery);